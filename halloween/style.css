/* style.css */

/* --- CSS HO√ÄN CH·ªàNH & RESPONSIVE --- */

/* --- CSS Chung --- */
body {
    background-color: #0d0d0d;
    font-family: 'Arial', sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    margin: 0;
    overflow: hidden;
    perspective: 1000px; 
}

/* --- Hi·ªáu ·ª©ng N·ªÅn (Canvas) --- */
#magicCanvas {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 1;
}

/* --- N√∫t B·∫≠t/T·∫Øt √Çm Thanh --- */
#soundToggle {
    position: fixed;
    top: 15px;
    right: 15px;
    font-size: 24px;
    cursor: pointer;
    color: #ff9900;
    z-index: 300; 
    transition: color 0.3s, transform 0.2s; /* Enhanced transition */
}
#soundToggle:hover {
    color: #ff69b4; 
    transform: scale(1.1) rotate(5deg); /* Lively hover */
}

/* --- Tr√°i Tim M·ªü ƒê·∫ßu --- */
.heart-wrapper {
    position: absolute;
    z-index: 200; 
    display: flex;
    justify-content: center;
    align-items: center;
    width: 100%;
    height: 100%;
    transition: opacity 0.8s ease-out, transform 0.8s ease-out;
}

.heart {
    font-size: 80px; 
    color: #ff4d4d; 
    cursor: pointer;
    animation: pulse-heart 1.5s infinite ease-in-out;
    text-shadow: 0 0 25px rgba(255, 77, 77, 1); /* Stronger glow */
    line-height: 1; 
    display: inline-block;
}

@keyframes pulse-heart {
    0% { transform: scale(1); filter: hue-rotate(0deg); }
    50% { transform: scale(1.15); filter: hue-rotate(10deg); } /* More exaggerated pulse */
    100% { transform: scale(1); filter: hue-rotate(0deg); }
}

/* Khi tr√°i tim bi·∫øn m·∫•t */
.heart-wrapper.hidden {
    opacity: 0;
    transform: scale(0.5) translateY(-50px); /* Add a slight upward movement */
    pointer-events: none; 
}

/* V·ªè th∆∞ */
.envelope-wrapper {
    position: relative;
    width: 300px;
    height: 200px;
    cursor: pointer;
    z-index: 100;
    transition: transform 0.8s, opacity 0.8s, box-shadow 0.5s; 
    box-shadow: 0 10px 50px rgba(255, 105, 180, 0.7); 
    
    /* TR·∫†NG TH√ÅI BAN ƒê·∫¶U: ·∫®n */
    opacity: 0;
    pointer-events: none;
    transform: scale(0.8);
    
    overflow: hidden; 
    border-radius: 5px; 
}

/* Hover effect for envelope (Lively) */
.envelope-wrapper:hover:not(.opened-state) {
    transform: scale(1.05) rotateZ(-1deg);
    box-shadow: 0 15px 70px rgba(255, 105, 180, 0.9);
}

/* Khi v·ªè th∆∞ hi·ªán ra (Sau khi click tr√°i tim) */
.envelope-wrapper.visible {
    opacity: 1;
    transform: scale(1);
    pointer-events: all;
}

/* --- TH√ÇN B√å TH∆Ø: H·ªíNG NH·∫†T K·∫∫ S·ªåC V√Ä TRANG TR√ç ƒê·∫∏P --- */
.envelope {
    position: absolute;
    width: 100%;
    height: 100%;
    background-color: #FFC0CB; /* Light Pink Base */
    
    /* H·ªåA TI·∫æT K·∫∫ S·ªåC H·ªíNG NH·∫†T */
    background-image: repeating-linear-gradient(
        45deg,
        #FFC0CB, /* Light Pink */
        #FFC0CB 10px,
        #FFD9E6 10px, /* Slightly Lighter Pink/White for stripe */
        #FFD9E6 20px
    );

    border-radius: 5px;
    z-index: 50;
    
    /* TRANG TR√ç: Th√™m vi·ªÅn ƒë·∫πp */
    border: 3px solid #ff99cc; 
    box-shadow: inset 0 0 15px rgba(0, 0, 0, 0.1); 
}

/* --- N·∫ÆP B√å TH∆Ø: V√ÄNG NH·∫∏ K·∫∫ S·ªåC V√Ä TRANG TR√ç ƒê·∫∏P --- */
.flap {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 50%;
    
    background-color: #FFFFAA; /* Light Yellow Base */
    
    /* H·ªåA TI·∫æT K·∫∫ S·ªåC V√ÄNG NH·∫†T */
    background-image: repeating-linear-gradient(
        -45deg, 
        #FFFFAA, 
        #FFFFAA 10px,
        #FFFFCC 10px, 
        #FFFFCC 20px
    );

    clip-path: polygon(0 0, 100% 0, 50% 100%); 
    
    transform-origin: top;
    transition: transform 0.8s ease-in-out, z-index 0s 0.8s;
    z-index: 150; 
    
    /* TRANG TR√ç: Th√™m vi·ªÅn d∆∞·ªõi (n∆°i n·∫Øp g·∫∑p th√¢n) */
    border-bottom: 3px solid #ffd700; 
}
/* Hi·ªáu ·ª©ng N·∫Øp Th∆∞ L·∫≠t */
.envelope-wrapper.open .flap {
    transform: rotateX(180deg);
    z-index: 40;
    transition: transform 0.8s ease-in-out, z-index 0s 0s;
}


/* --- N·ªôi Dung Thi·ªáp (Letter Content) --- */
.letter {
    position: absolute; 
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: #fff;
    padding: 20px;
    box-sizing: border-box;
    border-radius: 10px;
    
    transform: translate(0, 0); 
    
    transition: all 1.5s cubic-bezier(0.68, -0.55, 0.265, 1.55); 
    box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
    z-index: 45; 
    clip-path: none; 
    opacity: 0; 
    pointer-events: none; 
}

/* --- TR·∫†NG TH√ÅI M·ªû (K√çCH HO·∫†T PH√ìNG TO) --- */
.envelope-wrapper.opened-state {
    pointer-events: none; 
}

/* üõë KH·∫ÆC PH·ª§C L·ªñI PH√ìNG TO TRI·ªÜT ƒê·ªÇ */
.envelope-wrapper.opened-state > .letter { 
    position: fixed !important; 
    
    opacity: 1; 
    pointer-events: all; 
    z-index: 999; 

    /* K√≠ch th∆∞·ªõc PC/Tablet l·ªõn */
    width: 60vw; 
    height: 70vh; 
    max-width: 650px; 
    max-height: 600px;
    
    /* CƒÇN CH·ªàNH GI·ªÆA M√ÄN H√åNH */
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%); 
    
    /* TRANG TR√ç ƒê√ÅNG Y√äU CHO THI·ªÜP */
    border: 5px solid #FF69B4; 
    box-shadow: 0 0 50px rgba(255, 105, 180, 0.9); 
    
    clip-path: none; 
    border-radius: 10px;
}

/* L·ªõp ·∫©n v·ªè th∆∞ (k√≠ch ho·∫°t b·∫±ng JS sau khi thi·ªáp ph√≥ng to) */
.envelope-wrapper.hidden .envelope,
.envelope-wrapper.hidden .flap {
    opacity: 0;
}

/* --- MEDIA QUERY: T·ªëi ∆∞u cho M√†n h√¨nh ƒêi·ªán tho·∫°i (Width <= 600px) --- */
@media (max-width: 600px) {
    
    .envelope-wrapper {
        width: 250px;
        height: 160px;
    }

    .envelope-wrapper.opened-state > .letter { 
        /* Thi·ªáp Bung To chi·∫øm g·∫ßn h·∫øt m√†n h√¨nh */
        width: 95vw; 
        height: 95vh; 
        
        position: fixed !important; 
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%); 
        
        padding: 10px; 
        overflow-y: hidden; 
    }
    
    /* C·ª† CH·ªÆ PH√ô H·ª¢P CHO MOBILE */
    .letter-content {
        font-size: 0.85em; 
    }
    .letter-content h2 {
        font-size: 1.3em;
    }
}

/* --- CƒÇN CH·ªÆ V√ÄO GI·ªÆA THI·ªÜP --- */
.letter-content {
    display: flex;
    flex-direction: column; 
    justify-content: center; 
    align-items: center; 
    
    overflow-y: hidden; 
    
    text-align: center;
    color: #333;
    font-size: 1.1em; 
    line-height: 1.6;
    width: 100%;
    height: 100%;
    box-sizing: border-box;
    
    padding: 5px; 
}

.letter-content > * {
    max-width: 100%; 
    margin: 5px 0; 
}

/* --- Trang tr√≠ ƒê√°ng Y√™u cho ch·ªØ --- */
.letter-content h2 {
    color: #FF69B4; 
    margin-top: 0;
    font-size: 1.8em;
    text-shadow: 1px 1px 2px rgba(255, 192, 203, 0.5);
}

/* --- Hi·ªáu ·ª©ng Ch·ªØ ƒê·ªông (Typewriter Effect) --- */
.letter-content.typing-active p { opacity: 0; }
.letter-content.typing-active h2 { opacity: 0; }

.status-message {
    position: absolute;
    bottom: -50px;
    color: #ffd700;
    font-style: italic;
    font-size: 0.9em;
    width: 100%;
    text-align: center;
    animation: pulse 2s infinite;
    z-index: 10;
}
@keyframes pulse {
    0% { opacity: 0.8; }
    50% { opacity: 1; }
    100% { opacity: 0.8; }
}
